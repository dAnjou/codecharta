<div class="artificial-intelligence-component">
	<md-menu>
		<md-button
			class="suspicious-metrics-button"
			ng-click="$mdMenu.open($event);hideBadge = true;"
			title="Open Suspicious Metrics Panel"
		>
			<i class="fa fa-exclamation-triangle"></i>
			<span
				class="ai-badge"
				ng-show="
					!hideBadge &&
					($ctrl._viewModel.riskProfile !== undefined ||
						$ctrl._viewModel.overallSuspiciousMetricSuggestionLinks.length ||
						$ctrl._viewModel.unsuspiciousMetrics.length)
				"
			>
				{{ $ctrl._viewModel.overallSuspiciousMetricSuggestionLinks.length }}
			</span>
		</md-button>

		<md-menu-content class="ai-drop-down metrics">
			<div ng-repeat="language in $ctrl._viewModel.analyzedProgrammingLanguages">
				<md-menu-item class="title" ng-show="$ctrl._viewModel.unsuspiciousMetrics[$index].length">
					<span> Unsuspicious Metrics in {{ language }} code </span>
				</md-menu-item>

				<md-menu-item ng-show="$ctrl._viewModel.unsuspiciousMetrics[$index].length">
					<ul>
						<li ng-repeat="unsuspiciousMetric in $ctrl._viewModel.unsuspiciousMetrics[$index]">{{ unsuspiciousMetric }}</li>
					</ul>
				</md-menu-item>

				<md-menu-item class="title" ng-show="$ctrl._viewModel.suspiciousMetricSuggestionLinks.length">
					<span> Suspicious Metrics in {{ language }} code </span>
				</md-menu-item>

				<ul class="suspicious-metrics">
					<li class="suspicious-metric" ng-repeat="item in $ctrl._viewModel.suspiciousMetricSuggestionLinks[$index]">
						<md-button
							class="metric-button"
							ng-click="$ctrl.applySuspiciousMetric(item, $parent.$index, false)"
							title="Apply Map Configuration to show files with suspicious metric {{
								item.metric
							}} and high risk or very high risk depending on selection"
						>
							Suspicious {{ item.metric.toUpperCase() }} Files
						</md-button>

						<md-button
							class="risk-button"
							ng-click="$ctrl.applySuspiciousMetric(item, $parent.index, true)"
							ng-show="item.isOutlier"
							title="Show very high risk files"
						>
							<i class="fa fa-exclamation-triangle"></i>
						</md-button>
					</li>
				</ul>
			</div>
		</md-menu-content>
	</md-menu>

	<md-menu>
		<md-button class="high-risk-profile-button" ng-click="$mdMenu.open($event)" title="Open High Risk Profile">
			<i class="fa fa-bar-chart"></i>
		</md-button>

		<md-menu-content class="ai-drop-down summary">
			<div ng-repeat="riskProfile in $ctrl._viewModel.riskProfile">
				<md-menu-item class="title">
					<p ng-show="$ctrl._viewModel.analyzedProgrammingLanguages[$index]">
						Risk Profile for {{ $ctrl._viewModel.analyzedProgrammingLanguages[$index] }} code
					</p>
					<p ng-show="!$ctrl._viewModel.analyzedProgrammingLanguages[$index]">Risk Profile for overall code</p>
					<p>Calculations are always based on mcc (cyclomatic complexity)</p>
				</md-menu-item>

				<md-menu-item class="suspicious-metrics-summary">
					<ul ng-show="riskProfile !== undefined">
						<li>{{ riskProfile.lowRisk }}% of overall code is in files with low complexity</li>
						<li>{{ riskProfile.moderateRisk }}% of overall code is in files with moderate complexity</li>
						<li>{{ riskProfile.highRisk }}% of overall code is in files with high complexity</li>
						<li>{{ riskProfile.veryHighRisk }}% of overall code is in files with extreme complexity</li>
					</ul>
					<span ng-show="riskProfile === undefined"> Could not calculate Risk Profile. Metrics rloc and mcc not available. </span>
				</md-menu-item>

				<md-menu-item class="risk-profiles" ng-show="riskProfile !== undefined">
					<div
						ng-if="riskProfile.lowRisk > 0"
						title="Low Risk ({{ riskProfile.lowRisk }}% of code)"
						class="risk-profile low-risk"
						style="width:{{ riskProfile.lowRisk }}%;
					{{ riskProfile.lowRisk < 5 ? 'color:rgba(0,0,0,0)' : '' }}"
					>
						{{ riskProfile.lowRisk }}%
					</div>
					<div
						ng-if="riskProfile.moderateRisk > 0"
						title="Moderate Risk ({{ riskProfile.moderateRisk }}% of code)"
						class="risk-profile moderate-risk"
						style="width:{{ riskProfile.moderateRisk }}%;
					{{ riskProfile.moderateRisk < 5 ? 'color:rgba(0,0,0,0)' : '' }}"
					>
						{{ riskProfile.moderateRisk }}%
					</div>
					<div
						ng-if="riskProfile.highRisk > 0"
						title="High Risk ({{ riskProfile.highRisk }}% of code)"
						class="risk-profile high-risk"
						style="width:{{ riskProfile.highRisk }}%;
					{{ riskProfile.highRisk < 5 ? 'color:rgba(0,0,0,0)' : '' }}"
					>
						{{ riskProfile.highRisk }}%
					</div>
					<div
						ng-if="riskProfile.veryHighRisk > 0"
						title="Very High Risk ({{ riskProfile.veryHighRisk }}% of code)"
						class="risk-profile very-high-risk"
						style="width:{{ riskProfile.veryHighRisk }}%;
					{{ riskProfile.veryHighRisk < 5 ? 'color:rgba(0,0,0,0)' : '' }}"
					>
						{{ riskProfile.veryHighRisk }}%
					</div>
				</md-menu-item>
			</div>
		</md-menu-content>
	</md-menu>
</div>
